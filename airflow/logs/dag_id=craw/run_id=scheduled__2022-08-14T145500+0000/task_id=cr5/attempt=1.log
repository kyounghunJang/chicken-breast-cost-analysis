[2022-08-16 08:23:15,579] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [queued]>
[2022-08-16 08:23:15,589] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [queued]>
[2022-08-16 08:23:15,590] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2022-08-16 08:23:15,590] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2022-08-16 08:23:15,590] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2022-08-16 08:23:15,609] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): cr5> on 2022-08-14 14:55:00+00:00
[2022-08-16 08:23:15,614] {standard_task_runner.py:52} INFO - Started process 83 to run task
[2022-08-16 08:23:15,619] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'craw', 'cr5', 'scheduled__2022-08-14T14:55:00+00:00', '--job-id', '67', '--raw', '--subdir', 'DAGS_FOLDER/newtest.py', '--cfg-path', '/tmp/tmpea5ez1lb', '--error-file', '/tmp/tmp_18lhlh_']
[2022-08-16 08:23:15,622] {standard_task_runner.py:80} INFO - Job 67: Subtask cr5
[2022-08-16 08:23:15,731] {task_command.py:371} INFO - Running <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [running]> on host 74c2759f33bd
[2022-08-16 08:23:16,197] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=craw
AIRFLOW_CTX_TASK_ID=cr5
AIRFLOW_CTX_EXECUTION_DATE=2022-08-14T14:55:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-08-14T14:55:00+00:00
[2022-08-16 08:23:16,209] {base.py:68} INFO - Using connection ID 'mysql' for task execution.
[2022-08-16 08:23:16,212] {logger.py:11} INFO - ====== WebDriver manager ======
[2022-08-16 08:23:16,443] {logger.py:11} INFO - Get LATEST chromedriver version for google-chrome 104.0.5112
[2022-08-16 08:23:16,676] {logger.py:11} INFO - There is no [linux64] chromedriver for browser 104.0.5112 in cache
[2022-08-16 08:23:16,678] {logger.py:11} INFO - About to download new driver from https://chromedriver.storage.googleapis.com/104.0.5112.79/chromedriver_linux64.zip
[2022-08-16 08:23:20,823] {logger.py:11} INFO - Driver has been saved in cache [/home/***/.wdm/drivers/chromedriver/linux64/104.0.5112]
[2022-08-16 08:24:04,035] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_3086062/30860624618.20220209092012.jpg?type=f140 한성컴퓨터 GK200 RAINBOW 게이밍 기계식 키보드 36,900원 
[2022-08-16 08:24:27,761] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2897450/28974501586.20220803145130.jpg?type=f140 아이리버 MEDIC-BK1 항균 블루투스 키보드 39,402원 
[2022-08-16 08:24:51,522] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2336494/23364942490.20200706104104.jpg?type=f140 한성컴퓨터 GK787S OfficeMaster 체리 기계식키보드 79,101원 
[2022-08-16 08:25:15,182] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2013869/20138695528.20220610100245.jpg?type=f140 한성컴퓨터 GK898B OfficeMaster 한글 157,410원 
[2022-08-16 08:25:38,792] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_1013013/10130132704.20201113142036.jpg?type=f140 비프렌드 G-MASTER 레인보우 이중사출 청축 39,500원 
[2022-08-16 08:25:44,098] {logging_mixin.py:115} INFO - 1
[2022-08-16 08:26:07,712] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2183882/21838827773.20200129100927.jpg?type=f140 앱코 K611 텐키리스 카일광축 완전방수 축교환 게이밍 키보드 39,900원 
[2022-08-16 08:26:31,373] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_1727840/17278403481.20190130110759.jpg?type=f140 COX 엠프리스 RGB PBT 완전방수 무접점 키보드 180,000원 
[2022-08-16 08:26:55,131] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_1727812/17278124782.20190130110141.jpg?type=f140 COX 엔데버 텐키리스 RGB PBT 완전방수 무접점 키보드 150,000원 
[2022-08-16 08:27:05,558] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/newtest.py", line 63, in crawling
    price=driver.find_element(By.XPATH,'//*[@id="__next"]/div/div[2]/div[2]/div[3]/div[1]/ul/div/div[{}]/li/div/div[2]/div[2]/strong/span/span[2]'.format(i)).text
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/webdriver.py", line 859, in find_element
    'value': value})['value']
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/webdriver.py", line 435, in execute
    self.error_handler.check_response(response)
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/errorhandler.py", line 247, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"xpath","selector":"//*[@id="__next"]/div/div[2]/div[2]/div[3]/div[1]/ul/div/div[23]/li/div/div[2]/div[2]/strong/span/span[2]"}
  (Session info: headless chrome=104.0.5112.79)
Stacktrace:
#0 0x55e6b66a7403 <unknown>
#1 0x55e6b64ad778 <unknown>
#2 0x55e6b64e4c87 <unknown>
#3 0x55e6b64e4e51 <unknown>
#4 0x55e6b6517f24 <unknown>
#5 0x55e6b6502a2d <unknown>
#6 0x55e6b6515c74 <unknown>
#7 0x55e6b65028f3 <unknown>
#8 0x55e6b64d80d8 <unknown>
#9 0x55e6b64d9205 <unknown>
#10 0x55e6b66eee3d <unknown>
#11 0x55e6b66f1db6 <unknown>
#12 0x55e6b66d813e <unknown>
#13 0x55e6b66f29b5 <unknown>
#14 0x55e6b66cc970 <unknown>
#15 0x55e6b670f228 <unknown>
#16 0x55e6b670f3bf <unknown>
#17 0x55e6b6729abe <unknown>
#18 0x7f330ef04ea7 <unknown>

[2022-08-16 08:27:05,572] {taskinstance.py:1420} INFO - Marking task as UP_FOR_RETRY. dag_id=craw, task_id=cr5, execution_date=20220814T145500, start_date=20220816T082315, end_date=20220816T082705
[2022-08-16 08:27:05,587] {standard_task_runner.py:97} ERROR - Failed to execute job 67 for task cr5 (Message: no such element: Unable to locate element: {"method":"xpath","selector":"//*[@id="__next"]/div/div[2]/div[2]/div[3]/div[1]/ul/div/div[23]/li/div/div[2]/div[2]/strong/span/span[2]"}
  (Session info: headless chrome=104.0.5112.79)
Stacktrace:
#0 0x55e6b66a7403 <unknown>
#1 0x55e6b64ad778 <unknown>
#2 0x55e6b64e4c87 <unknown>
#3 0x55e6b64e4e51 <unknown>
#4 0x55e6b6517f24 <unknown>
#5 0x55e6b6502a2d <unknown>
#6 0x55e6b6515c74 <unknown>
#7 0x55e6b65028f3 <unknown>
#8 0x55e6b64d80d8 <unknown>
#9 0x55e6b64d9205 <unknown>
#10 0x55e6b66eee3d <unknown>
#11 0x55e6b66f1db6 <unknown>
#12 0x55e6b66d813e <unknown>
#13 0x55e6b66f29b5 <unknown>
#14 0x55e6b66cc970 <unknown>
#15 0x55e6b670f228 <unknown>
#16 0x55e6b670f3bf <unknown>
#17 0x55e6b6729abe <unknown>
#18 0x7f330ef04ea7 <unknown>
; 83)
[2022-08-16 08:27:05,628] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-08-16 08:27:05,661] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-08-16 08:29:15,924] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [queued]>
[2022-08-16 08:29:15,936] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [queued]>
[2022-08-16 08:29:15,936] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2022-08-16 08:29:15,937] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2022-08-16 08:29:15,937] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2022-08-16 08:29:15,952] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): cr5> on 2022-08-14 14:55:00+00:00
[2022-08-16 08:29:15,957] {standard_task_runner.py:52} INFO - Started process 6770 to run task
[2022-08-16 08:29:15,959] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'craw', 'cr5', 'scheduled__2022-08-14T14:55:00+00:00', '--job-id', '84', '--raw', '--subdir', 'DAGS_FOLDER/newtest.py', '--cfg-path', '/tmp/tmpm34hv0h6', '--error-file', '/tmp/tmp7rmgn63d']
[2022-08-16 08:29:15,961] {standard_task_runner.py:80} INFO - Job 84: Subtask cr5
[2022-08-16 08:29:16,027] {task_command.py:371} INFO - Running <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [running]> on host 74c2759f33bd
[2022-08-16 08:29:16,107] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=craw
AIRFLOW_CTX_TASK_ID=cr5
AIRFLOW_CTX_EXECUTION_DATE=2022-08-14T14:55:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-08-14T14:55:00+00:00
[2022-08-16 08:29:16,123] {base.py:68} INFO - Using connection ID 'mysql' for task execution.
[2022-08-16 08:29:16,125] {logger.py:11} INFO - ====== WebDriver manager ======
[2022-08-16 08:29:16,273] {logger.py:11} INFO - Get LATEST chromedriver version for google-chrome 104.0.5112
[2022-08-16 08:29:16,710] {logger.py:11} INFO - Driver [/home/***/.wdm/drivers/chromedriver/linux64/104.0.5112/chromedriver] found in cache
[2022-08-16 08:29:58,571] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_3086062/30860624618.20220209092012.jpg?type=f140 한성컴퓨터 GK200 RAINBOW 게이밍 기계식 키보드 36,900원 
[2022-08-16 08:30:22,130] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2897450/28974501586.20220803145130.jpg?type=f140 아이리버 MEDIC-BK1 항균 블루투스 키보드 39,402원 
[2022-08-16 08:30:45,704] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2336494/23364942490.20200706104104.jpg?type=f140 한성컴퓨터 GK787S OfficeMaster 체리 기계식키보드 79,101원 
[2022-08-16 08:31:09,229] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2013869/20138695528.20220610100245.jpg?type=f140 한성컴퓨터 GK898B OfficeMaster 한글 157,410원 
[2022-08-16 08:31:32,744] {logging_mixin.py:115} INFO - https://searchad-phinf.pstatic.net/MjAyMTEyMjFfMjgx/MDAxNjQwMDU2Njc2NjUy.Ob1_cxGTyqNiAIztA-Go5XzACCOEMTzg8KsXQBHAy9Ug.WLbtKsrkcXNkN2TdF96V2tP5GJs-W36zVQAB5pYADkEg.PNG/1871830-d9c5ef97-322f-4073-874e-584610ec51b1.png?type=f200 티앤에스인터내셔널 VALKAN 게이밍 키보드 64,400원 
[2022-08-16 08:31:37,961] {logging_mixin.py:115} INFO - 1
[2022-08-16 08:32:01,501] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_2183882/21838827773.20200129100927.jpg?type=f140 앱코 K611 텐키리스 카일광축 완전방수 축교환 게이밍 키보드 39,900원 
[2022-08-16 08:32:25,043] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_1727840/17278403481.20190130110759.jpg?type=f140 COX 엠프리스 RGB PBT 완전방수 무접점 키보드 180,000원 
[2022-08-16 08:32:48,617] {logging_mixin.py:115} INFO - https://shopping-phinf.pstatic.net/main_1727812/17278124782.20190130110141.jpg?type=f140 COX 엔데버 텐키리스 RGB PBT 완전방수 무접점 키보드 150,000원 
[2022-08-16 08:32:59,011] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/newtest.py", line 63, in crawling
    price=driver.find_element(By.XPATH,'//*[@id="__next"]/div/div[2]/div[2]/div[3]/div[1]/ul/div/div[{}]/li/div/div[2]/div[2]/strong/span/span[2]'.format(i)).text
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/webdriver.py", line 859, in find_element
    'value': value})['value']
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/webdriver.py", line 435, in execute
    self.error_handler.check_response(response)
  File "/home/airflow/.local/lib/python3.7/site-packages/selenium/webdriver/remote/errorhandler.py", line 247, in check_response
    raise exception_class(message, screen, stacktrace)
selenium.common.exceptions.NoSuchElementException: Message: no such element: Unable to locate element: {"method":"xpath","selector":"//*[@id="__next"]/div/div[2]/div[2]/div[3]/div[1]/ul/div/div[23]/li/div/div[2]/div[2]/strong/span/span[2]"}
  (Session info: headless chrome=104.0.5112.79)
Stacktrace:
#0 0x558bb929f403 <unknown>
#1 0x558bb90a5778 <unknown>
#2 0x558bb90dcc87 <unknown>
#3 0x558bb90dce51 <unknown>
#4 0x558bb910ff24 <unknown>
#5 0x558bb90faa2d <unknown>
#6 0x558bb910dc74 <unknown>
#7 0x558bb90fa8f3 <unknown>
#8 0x558bb90d00d8 <unknown>
#9 0x558bb90d1205 <unknown>
#10 0x558bb92e6e3d <unknown>
#11 0x558bb92e9db6 <unknown>
#12 0x558bb92d013e <unknown>
#13 0x558bb92ea9b5 <unknown>
#14 0x558bb92c4970 <unknown>
#15 0x558bb9307228 <unknown>
#16 0x558bb93073bf <unknown>
#17 0x558bb9321abe <unknown>
#18 0x7fbc2f45aea7 <unknown>

[2022-08-16 08:32:59,027] {taskinstance.py:1420} INFO - Marking task as UP_FOR_RETRY. dag_id=craw, task_id=cr5, execution_date=20220814T145500, start_date=20220816T082915, end_date=20220816T083259
[2022-08-16 08:32:59,045] {standard_task_runner.py:97} ERROR - Failed to execute job 84 for task cr5 (Message: no such element: Unable to locate element: {"method":"xpath","selector":"//*[@id="__next"]/div/div[2]/div[2]/div[3]/div[1]/ul/div/div[23]/li/div/div[2]/div[2]/strong/span/span[2]"}
  (Session info: headless chrome=104.0.5112.79)
Stacktrace:
#0 0x558bb929f403 <unknown>
#1 0x558bb90a5778 <unknown>
#2 0x558bb90dcc87 <unknown>
#3 0x558bb90dce51 <unknown>
#4 0x558bb910ff24 <unknown>
#5 0x558bb90faa2d <unknown>
#6 0x558bb910dc74 <unknown>
#7 0x558bb90fa8f3 <unknown>
#8 0x558bb90d00d8 <unknown>
#9 0x558bb90d1205 <unknown>
#10 0x558bb92e6e3d <unknown>
#11 0x558bb92e9db6 <unknown>
#12 0x558bb92d013e <unknown>
#13 0x558bb92ea9b5 <unknown>
#14 0x558bb92c4970 <unknown>
#15 0x558bb9307228 <unknown>
#16 0x558bb93073bf <unknown>
#17 0x558bb9321abe <unknown>
#18 0x7fbc2f45aea7 <unknown>
; 6770)
[2022-08-16 08:32:59,095] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-08-16 08:32:59,139] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-08-18 04:27:02,358] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [queued]>
[2022-08-18 04:27:02,547] {taskinstance.py:1179} INFO - Dependencies all met for <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [queued]>
[2022-08-18 04:27:02,555] {taskinstance.py:1376} INFO - 
--------------------------------------------------------------------------------
[2022-08-18 04:27:02,557] {taskinstance.py:1377} INFO - Starting attempt 1 of 2
[2022-08-18 04:27:02,563] {taskinstance.py:1378} INFO - 
--------------------------------------------------------------------------------
[2022-08-18 04:27:02,845] {taskinstance.py:1397} INFO - Executing <Task(PythonOperator): cr5> on 2022-08-14 14:55:00+00:00
[2022-08-18 04:27:02,884] {standard_task_runner.py:52} INFO - Started process 249 to run task
[2022-08-18 04:27:03,027] {standard_task_runner.py:79} INFO - Running: ['***', 'tasks', 'run', 'craw', 'cr5', 'scheduled__2022-08-14T14:55:00+00:00', '--job-id', '152', '--raw', '--subdir', 'DAGS_FOLDER/newtest.py', '--cfg-path', '/tmp/tmpkqy6k340', '--error-file', '/tmp/tmpv3_58f42']
[2022-08-18 04:27:03,031] {standard_task_runner.py:80} INFO - Job 152: Subtask cr5
[2022-08-18 04:27:03,579] {task_command.py:371} INFO - Running <TaskInstance: craw.cr5 scheduled__2022-08-14T14:55:00+00:00 [running]> on host d59619969b18
[2022-08-18 04:27:06,374] {taskinstance.py:1591} INFO - Exporting the following env vars:
AIRFLOW_CTX_DAG_OWNER=***
AIRFLOW_CTX_DAG_ID=craw
AIRFLOW_CTX_TASK_ID=cr5
AIRFLOW_CTX_EXECUTION_DATE=2022-08-14T14:55:00+00:00
AIRFLOW_CTX_TRY_NUMBER=1
AIRFLOW_CTX_DAG_RUN_ID=scheduled__2022-08-14T14:55:00+00:00
[2022-08-18 04:27:13,124] {taskinstance.py:1909} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 171, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/operators/python.py", line 189, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/newtest.py", line 40, in crawling
    conn= mysql_hook.get_conn()
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/providers/mysql/hooks/mysql.py", line 158, in get_conn
    conn = self.connection or self.get_connection(getattr(self, self.conn_name_attr))
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/hooks/base.py", line 67, in get_connection
    conn = Connection.get_connection_from_secrets(conn_id)
  File "/home/airflow/.local/lib/python3.7/site-packages/airflow/models/connection.py", line 430, in get_connection_from_secrets
    raise AirflowNotFoundException(f"The conn_id `{conn_id}` isn't defined")
airflow.exceptions.AirflowNotFoundException: The conn_id `mysql` isn't defined
[2022-08-18 04:27:13,152] {taskinstance.py:1420} INFO - Marking task as UP_FOR_RETRY. dag_id=craw, task_id=cr5, execution_date=20220814T145500, start_date=20220818T042702, end_date=20220818T042713
[2022-08-18 04:27:13,182] {standard_task_runner.py:97} ERROR - Failed to execute job 152 for task cr5 (The conn_id `mysql` isn't defined; 249)
[2022-08-18 04:27:13,249] {local_task_job.py:156} INFO - Task exited with return code 1
[2022-08-18 04:27:13,315] {local_task_job.py:273} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2022-08-18 04:27:13,374] {dagrun.py:1081} ERROR - Failed to get task '<TaskInstance: craw.con scheduled__2022-08-14T14:55:00+00:00 [removed]>' for dag 'craw'. Marking it as removed.
